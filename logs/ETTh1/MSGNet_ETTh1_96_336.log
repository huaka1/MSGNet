Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', conv_channel=32, d_ff=64, d_layers=1, d_model=32, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gcn_depth=2, gcn_dropout=0.3, gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='MSGNet', model_id='ETTh1_96_336', moving_avg=25, n_heads=8, node_dim=10, num_kernels=6, num_nodes=7, num_workers=8, output_attention=False, patience=3, pred_len=336, propalpha=0.3, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, skip_channel=32, subgraph_size=3, tanhalpha=3, target='OT', task_name='long_term_forecast', test_flop=False, top_k=3, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_336_MSGNet_ETTh1_ftM_sl96_ll48_pl336_dm32_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5153446
	speed: 0.1178s/iter; left time: 289.9201s
	iters: 200, epoch: 1 | loss: 0.4764564
	speed: 0.1115s/iter; left time: 263.2935s
Epoch: 1 cost time: 29.313544988632202
Epoch: 1, Steps: 256 | Train Loss: 0.5826919 Vali Loss: 1.3740933 Test Loss: 0.5175048
Validation loss decreased (inf --> 1.374093).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4869327
	speed: 0.2456s/iter; left time: 541.4966s
	iters: 200, epoch: 2 | loss: 0.4629549
	speed: 0.1112s/iter; left time: 234.1593s
Epoch: 2 cost time: 29.845523834228516
Epoch: 2, Steps: 256 | Train Loss: 0.5055786 Vali Loss: 1.3272525 Test Loss: 0.4844800
Validation loss decreased (1.374093 --> 1.327253).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4174950
	speed: 0.2494s/iter; left time: 485.9951s
	iters: 200, epoch: 3 | loss: 0.4635389
	speed: 0.1049s/iter; left time: 193.9415s
Epoch: 3 cost time: 28.59794044494629
Epoch: 3, Steps: 256 | Train Loss: 0.4771220 Vali Loss: 1.3217115 Test Loss: 0.4811106
Validation loss decreased (1.327253 --> 1.321712).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4147451
	speed: 0.2492s/iter; left time: 421.8353s
	iters: 200, epoch: 4 | loss: 0.5234513
	speed: 0.1097s/iter; left time: 174.8281s
Epoch: 4 cost time: 29.69049382209778
Epoch: 4, Steps: 256 | Train Loss: 0.4642275 Vali Loss: 1.3193145 Test Loss: 0.4829367
Validation loss decreased (1.321712 --> 1.319314).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4251087
	speed: 0.2430s/iter; left time: 349.1612s
	iters: 200, epoch: 5 | loss: 0.4437906
	speed: 0.1119s/iter; left time: 149.6231s
Epoch: 5 cost time: 29.24397873878479
Epoch: 5, Steps: 256 | Train Loss: 0.4572628 Vali Loss: 1.3185376 Test Loss: 0.4878816
Validation loss decreased (1.319314 --> 1.318538).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4450252
	speed: 0.2412s/iter; left time: 284.8433s
	iters: 200, epoch: 6 | loss: 0.4912592
	speed: 0.1080s/iter; left time: 116.7567s
Epoch: 6 cost time: 28.659883499145508
Epoch: 6, Steps: 256 | Train Loss: 0.4534726 Vali Loss: 1.3201487 Test Loss: 0.4847707
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5222778
	speed: 0.2419s/iter; left time: 223.7580s
	iters: 200, epoch: 7 | loss: 0.4199804
	speed: 0.1041s/iter; left time: 85.8651s
Epoch: 7 cost time: 28.277031421661377
Epoch: 7, Steps: 256 | Train Loss: 0.4521773 Vali Loss: 1.3209538 Test Loss: 0.4894978
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4343069
	speed: 0.2424s/iter; left time: 162.1965s
	iters: 200, epoch: 8 | loss: 0.4349911
	speed: 0.1101s/iter; left time: 62.6468s
Epoch: 8 cost time: 29.225209712982178
Epoch: 8, Steps: 256 | Train Loss: 0.4513591 Vali Loss: 1.3189197 Test Loss: 0.4871830
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_96_336_MSGNet_ETTh1_ftM_sl96_ll48_pl336_dm32_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
preds_shape: (79, 32, 336, 7)
trues_shape: (79, 32, 336, 7)
nd:0.591444194316864, nrmse:0.8727952837944031, mse:0.4878815710544586, mae:0.4733240604400635, rse:0.6650941967964172, mape:11.545368194580078
time: 292.7131872177124
